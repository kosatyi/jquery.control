!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).jQueryControl=n()}(this,(function(){"use strict";const t={};let n=!1;const e=/xyz/.test(function(){return"xyz"}.toString())?/\b_super\b/:/.*/,i=function(t,n,e){return function(){var i,r=this._super;return this._super=t[n],i=e.apply(this,arguments),this._super=r,i}},r=function(){};r.prototype._super=function(){},r.prototype.instance=function(t){return new this.constructor(t)},r.prototype.proxy=function(t){return t="string"==typeof t?this[t]:t,n=this,e=t,function(){return e.apply(n,[this].concat([].slice.call(arguments)))};var n,e},r.extend=function t(r,o){function s(){!n&&this.init&&this.init.apply(this,arguments)}return s.prototype=function(t,r){var o,s,c=t.prototype;for(o in n=!0,s=new t,n=!1,r)r.hasOwnProperty(o)&&("function"==typeof c[o]&&"function"==typeof r[o]&&e.test(r[o])?s[o]=i(c,o,r[o]):s[o]=r[o]);return s}(this,r),s.prototype.name=o,s.prototype.constructor=s,s.extend=t,s},r.createClass=function(n,e,i){return t[n]||(t[n]=(i?t[e]:r).extend(i||e,n)),t[n]},r.getClass=function(n,e){return"function"!=typeof t[n]?null:new t[n](e)};var o=r,s=window.jQuery;var c=function(t,n,e){let i={},r={true:!0,false:!1,null:null};return e&&(t=t.replace(/\+/g," ")),t.split("&").forEach((function(t){let e,o=t.split("="),s=decodeURIComponent(o[0]),c=i,u=0,a=s.split("]["),l=a.length-1;if(/\[/.test(a[0])&&/]$/.test(a[l])?(a[l]=a[l].replace(/]$/,""),a=a.shift().split("[").concat(a),l=a.length-1):l=0,2===o.length)if(e=decodeURIComponent(o[1]),n&&(e=e&&!isNaN(e)&&+e+""===e?+e:"undefined"===e?void 0:void 0!==r[e]?r[e]:e),l)for(;u<=l;u++)s=""===a[u]?c.length:a[u],c=c[s]=u<l?c[s]||(a[u+1]&&isNaN(a[u+1])?{}:[]):e;else"[object Array]"===Object.prototype.toString.call(i[s])?i[s].push(e):!{}.hasOwnProperty.call(i,s)?i[s]=e:i[s]=[i[s],e];else s&&(i[s]=n?void 0:"")})),i};const u=s,a=c;let l=!1;const h={prefix:"#",type:"hash",event:"hashchange.location",callbacks:[],initialize:!1,url:function(t,n){return location[!0===n?"replace":"assign"](t),this},normalize:function(t){let n=this.prefix;return(0===t.indexOf("http")||0===t.indexOf("#"))&&(n=""),[n,t].join("")},assign:function(t,n){return l=n,this.url(this.normalize(t))},replace:function(t,n){return l=n,this.url(this.normalize(t),!0)},href:function(){return location[this.type].slice(1)},part:function(t){return this.href().split("#")[0].split("?")[t]||""},query:function(t,n,e){if(!arguments.length)return a(this.part(1));t=t?[this.part(0),u.param(t)].join("?"):this.part(0),this[n?"replace":"assign"](t,e)},path:function(t,n,e){if(!arguments.length)return this.part(0);t=this.part(1)?[t,this.part(1)].join("?"):t||"/",this[n?"replace":"assign"](t,e)},json:function(t,n,e){let i=this.href().split("#")[0].split("?")[1]||"{}";if(!arguments.length){try{i=decodeURIComponent(i),i=JSON.parse(i)}catch(t){i={}}return i}t=t?[this.part(0),JSON.stringify(t)].join("?"):this.part(0),this[n?"replace":"assign"](t,e)},proxy:function(t){return n=this,function(){return n[t].apply(n,arguments)};var n},bind:function(t){this.callbacks.push(t),!1===this.initialize&&(this.initialize=!0,u(window).on(this.event,this.proxy("change")))},unbind:function(t){this.callbacks.splice(this.callbacks.indexOf(t),1)},host:function(){return location.host},indexOf:function(t,n){return this.href().indexOf(t)===n},change:function(){let t;if(!0===l)return l=!1;if(this.callbacks.length)for(t in this.callbacks)this.callbacks.hasOwnProperty(t)&&this.callbacks[t].call(this)}};var f=h,p={};const d=s,_=function(t){return Object.keys(t).sort().reduce((function(n,e){return n[e]=t[e],n}),{})},y=function(t){return JSON.stringify(t.slice().sort())};p.arrayStringify=_,p.compareArrays=function(t,n){return y(t)===y(n)},p.sortObject=_,p.isPlainObject=function(t){return d.isPlainObject(t)},p.isArray=function(t){return d.isArray(t)},p.forEach=function(t,n,e){let i,r=e||n;for(i in t)t.hasOwnProperty(i)&&n.call(r,t[i],i)};const g=s,m=o,{compareArrays:x,forEach:b}=p,v={},C=[],j="control",w="["+j+"]",k=m.extend({addControlClassName:!0,window:g(window),document:g(document),_addProxy_:function(t,n,e){return e.length===t&&(e[t-1]=this.proxy(e[t-1])),e.length===n&&(e[n-1]=this.proxy(e[n-1])),e},_event_:function(t,n){let e=this.toArray(n);return e=this._addProxy_(2,3,e),this.element[t].apply(this.element,e),this},init:function(t){this.pushInstance(),this.initElement(t),this.create(t)},pushInstance:function(){C.push(this)},initElement:function(t){this.element=g(t),!0===this.addControlClassName&&this.element.addClass(this.name.split(".").join("-"))},create:function(t){},toArray:function(t){return Array.prototype.slice.call(t)},initBindings:function(){this._bindings_||(this._bindings_=[])},addBinding:function(t){this.initBindings(),this._bindings_.push([].concat(t))},proxy:function(t){return this._proxy_cache_||(this._proxy_cache_={}),this._proxy_cache_[t]||(this._proxy_cache_[t]=this._super(t)),this._proxy_cache_[t]},find:function(){return this.element.find.apply(this.element,arguments)},el:function(t,n,e){return t=g(document.createElement(t)),n&&t.addClass(n),e&&t.attr(e),t},clearProxyCache:function(){b(this._proxy_cache_,(function(t,n){delete this._proxy_cache_[n]}),this)},bind:function(){let t,n=this.toArray(arguments);return this.addBinding(n),n=this._addProxy_(3,4,n),t=this[n[0]]||g(n[0]),t.on.apply(t,n.slice(1)),this},unbind:function(){var t,n=this.toArray(arguments);return this._bindings_=this._bindings_.filter((function(t){return!1===x(t,n)}),this),(t=this[(n=this._addProxy_(3,4,n))[0]]||g(n[0])).off.apply(t,n.slice(1)),this},unbindAll:function(){return this.initBindings(),this._bindings_.forEach((function(t){this.unbind.apply(this,t)}),this),this._bindings_=[],this},on:function(){return this._event_("on",arguments),this},off:function(){return this._event_("off",arguments),this},timeout:function(t,n){return this._idle_timeout_||(this._idle_timeout_={}),clearTimeout(this._idle_timeout_[t]),delete this._idle_timeout_[t],!1===n||(this._idle_timeout_[t]=setTimeout(this.proxy(t),n)),this},destroy:function(){this.off(),this.unbindAll(),this.clearProxyCache(),this.element.removeClass(this.name.split(".").join("-")),this.element.removeData()},canBeDestroyed:function(){return!1===this.document.contains(this.element)}});k.createControl=function(t,n,e){return v[t]?(console.info("control with name [%s] is already exist",t),v[t]):(v[t]=(e?v[n]:k).extend(e||n,t),v[t])},k.sortControls=function(t,n){let e=t.querySelectorAll(w).length,i=n.querySelectorAll(w).length;return e&&!i||e>i?1:!e&&i||e<i?-1:0},k.cleanControls=function(t){C.forEach((function(n,e){(n.canBeDestroyed()||t)&&(n.destroy(),C.splice(e,1))}))},k.initControl=function(t,n){if("function"==typeof v[t])return new v[t](n)},k.initControls=function(t){k.cleanControls(),Array.prototype.slice.call(t.querySelectorAll(w)).sort(k.sortControls).forEach((function(t){t.getAttribute(j).split(",").forEach((function(n){k.initControl(n,t)})),t.removeAttribute(j)}))};var q=k;const O=s,A=o,{isArray:E,isPlainObject:P,forEach:M,sortObject:S}=p,z={},D=A.extend({init:function(t){this.extend(t)},extend:function(t){this.$data=t||{}},alt:function(t,n){return void 0===(t=this.attr(t))?n:t},ns:function(t){let n=this,e=t.split("."),i=this.attr(e.slice(0,-1).join("."));return i instanceof D&&(n=i),[n,e.slice(-1).join(".")]},on:function(t,n){let e=this.ns(t);return O.event.add(e[0],e[1],n),this},off:function(t,n){let e=this.ns(t);return O.event.remove(e[0],e[1],n),this},trigger:function(t,n){let e=this.ns(t);return O.event.trigger(e[1],n,e[0],!0),this},$update:function(){},$change:function(){},defer:function(){return O.Deferred()},resolve:function(){return this.defer().resolve(this)},attr:function(t,n){let e,i=0,r=this.$data,o=(t||"").split("."),s=o.pop(),c=arguments.length;for(;i<o.length;i++)if(r&&r.hasOwnProperty(o[i])){if(r[o[i]]&&"function"==typeof r[o[i]].attr)return e=[t.split(".").slice(i+1).join(".")],2===c&&e.push(n),r[o[i]].attr.apply(r[o[i]],e);r=r[o[i]]}else{if(2!==c)break;r=r[o[i]]={}}return 1===c?r?r[s]:void 0:(2===c&&(e=r[s],r[s]=n,this.$change(t,n,e)),this)},eachItem:function(t){let n=t[1]?t[0]:null,e=t[1]?t[1]:t[0],i=n?this.alt(n,[]):this.$data;return{value:S(i),isArray:E(i),callback:e}},each:function(){let t=this.eachItem(arguments);M(t.value,(function(n,e){t.callback(this.instance(n),n,e)}),this)},attrs:function(t){return this.$data=function t(n,e,i){let r;for(r in n)n.hasOwnProperty(r)&&(e[r]&&"function"==typeof e[r].attrs?e[r].attrs(n[r],r):E(n[r])||P(n[r])?(E(n[r])&&(e[r]=e[r]||[]),P(n[r])&&(e[r]=e[r]||{}),t.call(this,n[r],e[r],r)):e[r]=n[r],this.$change(i?i.concat(".",r):r,n[r],e[r]));return e}.call(this,t,this.$data),this.$update(t,this.$data),this},serialize:function(){return function t(n,e){let i;for(i in e)e.hasOwnProperty(i)&&(e[i]&&"function"==typeof e[i].serialize?n[i]=e[i].serialize():E(e[i])||P(e[i])?(E(e[i])&&(n[i]=[]),P(e[i])&&(n[i]={}),t.call(this,n[i],e[i])):n[i]=e[i]);return n}.call(this,{},this.$data)},stringify:function(){return JSON.stringify(this.serialize())}});D.createModel=function(t,n,e){return z[t]||(z[t]=(e?z[n]:D).extend(e||n,t)),z[t]},D.getModel=function(t,n){if("function"==typeof z[t])return new z[t](n)};var N=D;const R=s,T={},F={defaults:"en",current:"en",path:"locales/",file:"/translation.json",data:{},load:function(t){return T[t]=T[t]||R.ajax({context:this,url:this.path.concat(t).concat(this.file)}),T[t].then((function(t){this.data=t})),T[t]},config:function(t){return R.extend(!0,F,t),F},lang:function(t){return this.current=t,this},get:function(t){return this.data[t]||t}};var I=F;const B=jQuery,L=c,H=/[^\[\]]+|\[\]$/g;function U(t){let n;for(n in t)t.hasOwnProperty(n)&&(0===t[n].length?(B.isArray(t)&&t.splice(n,1),B.isPlainObject(t)&&delete t[n]):"object"==typeof t[n]&&U(t[n]));return t}var J={setFormData:function(t){return this.find("[name]").each((function(){let n=B(this),e=n.attr("name").match(H),i=function(t,n){for(var e=0,i=(n||"").split("."),r=i.pop();e<i.length&&t&&t.hasOwnProperty(i[e]);e++)t=t[i[e]];return t?t[r]:null}(t,e.join("."));i&&(n.is(":radio")?n.val()===i&&n.attr("checked",!0):n.is(":checkbox")?(i=B.isArray(i)?i:[i],B.inArray(n.val(),i)>-1&&n.attr("checked",!0)):n.val(i))})),this},getFormData:function(t,n){let e=B.map(this.serializeArray(),(function(t){return[t.name,encodeURIComponent(t.value)].join("=")})).join("&"),i=L(e,n,!1);return!0===t?U(i):i}};const Q=s,W=o,G=q,K={},V={},X={},Y={},Z={},tt=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,et=/<%-([\s\S]+?)%>/g,it=/(.)^/,rt={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},ot=/[\\'\r\n\t\u2028\u2029]/g,st={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},ct=new RegExp("[&<>\"']","g"),ut=function(t,n,e){let i,r=e||n;for(i in t)t.hasOwnProperty(i)&&n.call(r,t[i],i)},at=function(t,n){return(t||"").replace(/{(.+?)}/g,(function(t,e){return void 0!==n[e]?n[e]:t}))},lt=function(t){let n=1e6,e=String(n).length-1,i=Math.abs(Math.random())*n,r=String((new Date).getTime()).match(/.{1,7}/g),o=parseFloat(String(i)).toFixed(e).split(".");return[t].concat(o).concat(r).join("-")},ht=function(t){return null==t?"":(""+t).replace(ct,(function(t){return st[t]}))},ft=function(t,n){let e,i=new RegExp([(et||it).source,(nt||it).source,(tt||it).source].join("|")+"|$","g"),r=0,o="__p+='";(t||"").replace(i,(function(n,e,i,s,c){var u;return o+=null==(u=t.slice(r,c))?"":(""+u).replace(ot,(function(t){return"\\"+rt[t]})),e&&(o+="'\n+((__t=("+e+"))==null?'':escapeExpr(__t))+\n'"),i&&(o+="'\n+((__t=("+i+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+";\n__p+='"),r=c+n.length,n})),o+="';",o="with(obj||{}){\n"+o+"}",o="var __t,__p='',__j=[].join,print=function(){__p+=__j.call(arguments,'');};"+o+"return __p;\n//# sourceURL=["+n+"]";try{e=new Function("obj","escapeExpr",o)}catch(t){console.error(t)}let s=function(t){let n="";try{n=e&&e.call(this,t,ht)}catch(t){console.error(t)}return n};return s.source="function(obj){"+o+"}",s},pt=W.extend({init:function(t,n){this.source=yt.source(t),this.compile(this.source,n)},compile:function(t,n){return this.output=ft(t,n),this},renderHTML:function(t){return t=this.extend(t),this.output.call(t,t)},render:function(t){let n=function(t){let n=document.createElement("template");if("content"in n)return n.innerHTML=t,document.importNode(n.content,!0);let e=document.createDocumentFragment(),i=document.createElement("div");for(i.innerHTML=t;i.firstChild;)e.appendChild(i.firstChild);return e}(this.renderHTML(t));return function(t){ut(X,(function(n,e,i,r){if(null===(i=t.getElementById(e)))return!1;r=document.createElement(n.tag),i.parentNode&&i.parentNode.replaceChild(r,i),"function"==typeof n.callback&&n.callback(r),delete X[e]}))}(n),function(t){ut(Y,(function(n,e){let i=t.querySelector(n.selector);null!==i&&(i.removeAttribute(e),"function"==typeof n.callback&&n.callback(i),delete Y[e])}))}(n),n},extend:function(t){return Q.extend({},this,t||{},gt)}}),dt=["ejs","html","svg","css","js"],_t=function(t){return new RegExp("^(.+)(\\.)("+t.join("|")+")$")},yt={ext:dt,exp:_t(dt),set:function(t){this.ext=t,this.exp=_t(t)},name:function(t){return String(t).replace(this.exp,"$1")},get:function(t){let n=0,e=!1,i=this.ext,r=V,o=this.name(t);for(;n<i.length&&(e=r[[o,i[n]].join(".")],!e);n++);return e},source:function(t){return this.get(t)||t}},gt={$include:function(t,n){return mt(at(t,this)).renderHTML(n)},$each:function(t,n,e){ut(t,n,e)},$view:function(t,n){let e=lt("node");return X[e]={tag:t,callback:n},at('<view id="{0}"></view>',[e])},$prop:function(t){let n=lt("attr");return Y[n]={selector:["[",n,"]"].join(""),callback:t},["",n,""].join(" ")},$control:function(t,n,e){return this.$view(t,(function(t){G.initControl(n,t)}))}};function mt(t){return Z[t]||(Z[t]=new pt(t)),Z[t]}mt.resolver=yt,mt.preload=function(t){return K[t]=K[t]||Q.get(t).then((function(t){Q.extend(V,t)})),K[t]},mt.helper=function(t,n){gt[t]=n};var xt=mt;const bt=s,vt=o,Ct=N,jt=xt,wt=q,kt=f,qt={hashchange:function(t){kt.bind((function(){t(this.path())})),""===kt.part(0)?kt.assign("/"):t(kt.path())}};Ct.createModel("router.queue",{init:function(t){this.response=t,this.start()},start:function(){this.list={},this.defer=bt.Deferred(),this.defer.progress((function(t,n){this.complete(t,n)}))},empty:function(){return bt.isEmptyObject(this.list)},complete:function(t,n){this.remove(t),this.response.attr(t,n),this.empty()&&(this.defer.resolve(),this.start())},remove:function(t){delete this.list[t]},then:function(t){return this.empty()?t():this.defer.then(t),this},stop:function(){Object.keys(this.list).forEach((function(t){this.list[t].reject(),this.remove(t)}),this),this.list={}},add:function(t,n){let e=this;return e.list[t]=n.then((function(n){e.defer.notifyWith(e,[t,n])}),(function(){e.defer.notifyWith(e,[t])})),e}}),Ct.createModel("router.response",{init:function(t){this.extend(t),this.__q=Ct.getModel("router.queue",this)},queue:function(t,n){return this.__q.add(t,n),this},then:function(t){return this.__q.then(t),this},stop:function(){return this.__q.stop(),this},render:function(t,n,e){return t=document.querySelector(t),n=jt(n).render(e),t.innerHTML="",t.appendChild(n),wt.initControls(t),t}}),Ct.createModel("router.request",{query:function(){let t=kt.query();return this.attr("query",t),t},match:function(t){return new RegExp(t).test(this.attr("path"))},model:function(){let t=[].slice.call(arguments),n=t.shift(),e=t.shift(),i=Ct.getModel(n);return e&&"function"==typeof i[e]?i[e].apply(i,t):i},getChildPath:function(){return"/".concat(this.alt("params._path_",""))},path:function(t){this.attr("path",t)},params:function(t){t=bt.extend({},this.alt("parent",{}),t),this.attr("params",t),this.attr("parent",t)}}),vt.createClass("route",{init:function(t){this.params={},this.callbacks=[],this.name=t,this.regex=function(t){let n,e=[];return t=(t=t.concat("/?")).replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,(function(t,n,i,r,o,s){return e.push({name:r,optional:!!s}),n=n||"",(s?"":n)+"(?:"+(s?n:"")+(i||"")+(o||i&&"([^/.]+?)"||"([^/]+?)")+")"+(s||"")})).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)").replace(/@num/g,"\\d+").replace(/@word/g,"\\w+"),n=new RegExp("^"+t+"$",""),n.keys=e,n}(t)},then:function(t){return this.callbacks.push(t),this},match:function(t){return this.path=t,this.params=function(t,n){let e,i=t.exec(n),r={};if(!i)return!1;for(var o=1,s=i.length;o<s;++o)(e=t.keys[o-1])&&(r[e.name]="string"==typeof i[o]?decodeURIComponent(i[o]):i[o]);return r}(this.regex,this.path),!!this.params},getCallbacks:function(){return this.callbacks}});const Ot=vt.createClass("router",{init:function(){this._before_=[],this._after_=[],this._routes_={},this.request=Ct.getModel("router.request"),this.response=Ct.getModel("router.response")},prepare:function(){this.request.attr("path",""),this.request.attr("params",{}),this.request.attr("parent",{}),this.response.attr("data",{}),this.response.stop()},route:function(t){let n=this._routes_[t]||vt.getClass("route",t);return this._routes_[t]=n,n},use:function(t){return this.route(t.concat("/",":_path_(*)?"))},before:function(t){return this._before_.push(t),this},after:function(t){return this._after_.push(t),this},call:function(t,n,e,i){this.request=n,this.response=e,this.find(this.request.getChildPath(),i)},apply:function(t,n){this.call(t,n[0],n[1],n[2])},process:function(t,n){!function e(i,r){let o=[];if(!1===(t[r]||!1))return n&&n.call&&n.call(i);o.push(i.request),o.push(i.response),o.push((function(){i.response.then((function(){e(i,++r)}))})),t[r].apply(i,o)}(this,0)},start:function(t,n){this.request.path(t.path),this.request.params(t.params),this.request.query(),this.process(this._before_,(function(){this.process(t.getCallbacks(),(function(){this.process(this._after_,n)}))}))},find:function(t,n){let e,i=vt.getClass("route",t);for(e in!0===n&&this.prepare(),this._routes_)if(this._routes_.hasOwnProperty(e)&&(e=this._routes_[e],e.match(t))){i=e;break}this.start(i,n)},listen:function(t){var n;return"string"==typeof t&&"function"==typeof qt[t]&&(t=qt[t]),t((n=this,function(t){n.find(t,!0)})),this}});const $=jQuery,$t=o,At=f,Et=q,Pt=N,Mt=I,St=J,zt=Ot,Dt=xt;return $.Class=$t,$.Model=Pt,$.Control=Et,$.Router=zt,$.createClass=$t.createClass,$.getClass=$t.getClass,$.createModel=Pt.createModel,$.getModel=Pt.getModel,$.createControl=Et.createControl,$.initControl=Et.initControl,$.location=At,$.locale=Mt,$.ejs=Dt,$.fn.extend({setFormData:St.setFormData,getFormData:St.getFormData,initControls:function(){this.each((function(t,n){Et.initControls(n)}))}}),$}));
//# sourceMappingURL=jquery.control.min.js.map
